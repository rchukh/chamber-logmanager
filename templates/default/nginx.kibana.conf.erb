##
# Rewrites are needed only because of sub-folder deployment
##

location /kibana {
  index  index.html  index.htm;
}

location ~ ^/kibana/_aliases$ {
  rewrite ^/kibana(/.*)$ $1 break;
  proxy_pass http://elasticsearch;
  proxy_read_timeout 90;
}
location ~ ^/kibana/.*/_aliases$ {
  rewrite ^/kibana(/.*)$ $1 break;
  proxy_pass http://elasticsearch;
   proxy_read_timeout 90;
}
location ~ ^/kibana/_nodes$ {
  rewrite ^/kibana(/.*)$ $1 break;
  proxy_pass http://elasticsearch;
  proxy_read_timeout 90;
}
location ~ ^/kibana/.*/_search$ {
  rewrite ^/kibana(/.*)$ $1 break;
  proxy_pass http://elasticsearch;
  proxy_read_timeout 90;
}
location ~ ^/kibana/.*/_mapping$ {
  rewrite ^/kibana(/.*)$ $1 break;
  proxy_pass http://elasticsearch;
  proxy_read_timeout 90;
}
location ~ ^/kibana/_cluster/health$ {
  rewrite ^/kibana(/.*)$ $1 break;
  proxy_pass http://elasticsearch;
  proxy_read_timeout 90;
}

# password protected end points
location ~ ^/kibana/kibana-int/dashboard/.*$ {
  rewrite ^/kibana(/.*)$ $1 break;
  proxy_pass http://elasticsearch;
  proxy_read_timeout 90;
}
location ~ ^/kibana/kibana-int/temp.*$ {
  rewrite ^/kibana(/.*)$ $1 break;
  proxy_pass http://elasticsearch;
  proxy_read_timeout 90;
}
